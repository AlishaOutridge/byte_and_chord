# Enable Rewrite Engine
RewriteEngine On

# Redirect to non-www
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

# Enable POST requests for all
<LimitExcept GET>
    Allow from all
</LimitExcept>

# Handle PHP files
AddType application/x-httpd-php .php
AddHandler x-httpd-php .php

# Security headers
Header set Content-Security-Policy "default-src 'self'"
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "SAMEORIGIN"

# Compress text files
AddOutputFilterByType DEFLATE text/plain text/html text/xml text/css application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript

# Protect the .htaccess itself
<Files .htaccess>
    order allow,deny
    deny from all
</Files>
